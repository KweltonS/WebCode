{"project":["Web Proj","Макет 1",[[[0,false,true,true,true,false,false,true,false,false,true,false,false,true,false,false,true,true,false,1,""]],[]],[["iframe",0,false,[],0,0,null,null,[],false,true,953432771809560,[],null,0,null]],[],[["Макет 1",1080,1920,false,false,0.5,0.5,"Список событий 1",616487866841269,[["Слой 0",0,876347163209865,true,[94,94,94],false,1,1,1,false,false,1,0,true,[[[0,0,0,1080,1920,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,["",""]],0,2,[],[],["","<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Code Projects</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: 'Segoe UI', system-ui, sans-serif;\n            -webkit-tap-highlight-color: transparent;\n        }\n\n        :root {\n            --bg-primary: #1e1e1e;\n            --bg-secondary: #252526;\n            --bg-tertiary: #2d2d30;\n            --accent-color: #007acc;\n            --accent-hover: #1177bb;\n            --text-primary: #cccccc;\n            --text-secondary: #969696;\n            --border-color: #3e3e42;\n            --success-color: #4EC9B0;\n            --error-color: #F44747;\n        }\n\n        body {\n            background-color: var(--bg-primary);\n            color: var(--text-primary);\n            height: 100vh;\n            overflow: hidden;\n            touch-action: manipulation;\n        }\n\n        .app-container {\n            display: flex;\n            flex-direction: column;\n            height: 100vh;\n        }\n\n        /* Header */\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 15px;\n            background-color: var(--bg-secondary);\n            border-bottom: 1px solid var(--border-color);\n            min-height: 48px;\n        }\n\n        .logo {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            font-size: 16px;\n            font-weight: 600;\n        }\n\n        .logo i {\n            color: var(--accent-color);\n            font-size: 18px;\n        }\n\n        .header-actions {\n            display: flex;\n            gap: 10px;\n        }\n\n        .btn {\n            background: var(--accent-color);\n            color: white;\n            border: none;\n            padding: 10px 16px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            touch-action: manipulation;\n            min-height: 44px;\n            min-width: 44px;\n        }\n\n        .btn:active {\n            background: var(--accent-hover);\n            transform: scale(0.98);\n        }\n\n        .btn-secondary {\n            background: var(--bg-tertiary);\n        }\n\n        /* Project Manager Screen */\n        .project-manager {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            padding: 20px;\n            gap: 30px;\n        }\n\n        .welcome-section {\n            text-align: center;\n            max-width: 500px;\n        }\n\n        .welcome-title {\n            font-size: 28px;\n            margin-bottom: 10px;\n            color: var(--accent-color);\n        }\n\n        .welcome-subtitle {\n            color: var(--text-secondary);\n            margin-bottom: 30px;\n        }\n\n        .project-actions {\n            display: flex;\n            gap: 20px;\n            flex-wrap: wrap;\n            justify-content: center;\n        }\n\n        .action-card {\n            background: var(--bg-secondary);\n            border: 1px solid var(--border-color);\n            border-radius: 8px;\n            padding: 30px;\n            width: 280px;\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            touch-action: manipulation;\n        }\n\n        .action-card:active {\n            border-color: var(--accent-color);\n            transform: translateY(-2px);\n        }\n\n        .action-icon {\n            font-size: 40px;\n            color: var(--accent-color);\n            margin-bottom: 15px;\n        }\n\n        .action-title {\n            font-size: 18px;\n            margin-bottom: 10px;\n        }\n\n        .action-description {\n            color: var(--text-secondary);\n            font-size: 14px;\n        }\n\n        /* Editor Screen */\n        .editor-screen {\n            flex: 1;\n            display: none;\n            flex-direction: column;\n            overflow: hidden;\n        }\n\n        .editor-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 15px;\n            background-color: var(--bg-secondary);\n            border-bottom: 1px solid var(--border-color);\n        }\n\n        .project-info {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n\n        .project-title {\n            font-size: 16px;\n            font-weight: 600;\n        }\n\n        .project-language-badge {\n            background: var(--accent-color);\n            color: white;\n            padding: 2px 8px;\n            border-radius: 10px;\n            font-size: 12px;\n        }\n\n        .editor-controls {\n            display: flex;\n            gap: 10px;\n        }\n\n        /* Code Editor */\n        .code-area {\n            flex: 1;\n            display: flex;\n            position: relative;\n        }\n\n        .line-numbers {\n            background-color: var(--bg-secondary);\n            padding: 15px 8px;\n            text-align: right;\n            color: var(--text-secondary);\n            font-size: 14px;\n            line-height: 1.5;\n            user-select: none;\n            overflow: hidden;\n            min-width: 50px;\n        }\n\n        #code-input {\n            flex: 1;\n            background-color: var(--bg-primary);\n            color: var(--text-primary);\n            border: none;\n            padding: 15px;\n            font-size: 14px;\n            line-height: 1.5;\n            resize: none;\n            font-family: 'Courier New', monospace;\n            tab-size: 4;\n            white-space: pre;\n            overflow: auto;\n            touch-action: manipulation;\n        }\n\n        /* Output Panel */\n        .output-panel {\n            height: 200px;\n            background-color: var(--bg-secondary);\n            border-top: 1px solid var(--border-color);\n            display: flex;\n            flex-direction: column;\n        }\n\n        .panel-content {\n            padding: 15px;\n            flex: 1;\n            overflow: auto;\n            font-family: 'Courier New', monospace;\n            font-size: 14px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n        }\n\n        .error-message {\n            color: var(--error-color);\n        }\n\n        .success-message {\n            color: var(--success-color);\n        }\n\n        /* Status Bar */\n        .status-bar {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 5px 15px;\n            background-color: var(--accent-color);\n            font-size: 12px;\n            min-height: 22px;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.7);\n            z-index: 1000;\n            justify-content: center;\n            align-items: center;\n        }\n\n        .modal-content {\n            background-color: var(--bg-secondary);\n            border-radius: 8px;\n            width: 90%;\n            max-width: 500px;\n            overflow: hidden;\n        }\n\n        .modal-header {\n            padding: 15px 20px;\n            background-color: var(--bg-tertiary);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .modal-title {\n            font-weight: 600;\n            font-size: 18px;\n        }\n\n        .modal-close {\n            background: none;\n            border: none;\n            color: var(--text-primary);\n            font-size: 20px;\n            cursor: pointer;\n            min-width: 44px;\n            min-height: 44px;\n        }\n\n        .modal-body {\n            padding: 20px;\n        }\n\n        .form-group {\n            margin-bottom: 20px;\n        }\n\n        .form-label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: 500;\n        }\n\n        .form-input, .form-select {\n            width: 100%;\n            padding: 12px;\n            background: var(--bg-primary);\n            border: 1px solid var(--border-color);\n            border-radius: 4px;\n            color: var(--text-primary);\n            font-size: 16px; /* Larger for mobile */\n            touch-action: manipulation;\n        }\n\n        .modal-footer {\n            padding: 15px 20px;\n            background-color: var(--bg-tertiary);\n            display: flex;\n            justify-content: flex-end;\n            gap: 10px;\n        }\n\n        /* Mobile Optimizations */\n        @media (max-width: 768px) {\n            .project-actions {\n                flex-direction: column;\n                align-items: center;\n            }\n            \n            .action-card {\n                width: 100%;\n                max-width: 300px;\n            }\n            \n            .btn span {\n                display: none;\n            }\n            \n            .output-panel {\n                height: 150px;\n            }\n            \n            #code-input {\n                font-size: 16px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"app-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"logo\">\n                <i class=\"fas fa-code\"></i>\n                <span>Code Projects</span>\n            </div>\n            <div class=\"header-actions\">\n                <button class=\"btn btn-secondary\" id=\"back-to-projects\">\n                    <i class=\"fas fa-arrow-left\"></i>\n                    <span>Projects</span>\n                </button>\n            </div>\n        </div>\n\n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <!-- Project Manager Screen -->\n            <div class=\"project-manager\" id=\"project-manager\">\n                <div class=\"welcome-section\">\n                    <h1 class=\"welcome-title\">Добро пожаловать</h1>\n                    <p class=\"welcome-subtitle\">Создавайте новые проекты или продолжайте работу над существующими</p>\n                    \n                    <div class=\"project-actions\">\n                        <div class=\"action-card\" id=\"create-project-btn\">\n                            <div class=\"action-icon\">\n                                <i class=\"fas fa-plus-circle\"></i>\n                            </div>\n                            <div class=\"action-title\">Создать проект</div>\n                            <div class=\"action-description\">Создайте новый проект с выбранным языком программирования</div>\n                        </div>\n                        \n                        <div class=\"action-card\" id=\"load-project-btn\">\n                            <div class=\"action-icon\">\n                                <i class=\"fas fa-folder-open\"></i>\n                            </div>\n                            <div class=\"action-title\">Загрузить проект</div>\n                            <div class=\"action-description\">Откройте существующий проект из вашей коллекции</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Editor Screen -->\n            <div class=\"editor-screen\" id=\"editor-screen\">\n                <div class=\"editor-header\">\n                    <div class=\"project-info\">\n                        <div class=\"project-title\" id=\"current-project-name\">Новый проект</div>\n                        <div class=\"project-language-badge\" id=\"current-project-language\">JS</div>\n                    </div>\n                    <div class=\"editor-controls\">\n                        <button class=\"btn\" id=\"run-btn\">\n                            <i class=\"fas fa-play\"></i>\n                            <span>Run</span>\n                        </button>\n                        <button class=\"btn\" id=\"save-project-btn\">\n                            <i class=\"fas fa-save\"></i>\n                            <span>Save</span>\n                        </button>\n                    </div>\n                </div>\n\n                <div class=\"editor-area\">\n                    <div class=\"editor-container\">\n                        <div class=\"code-container\">\n                            <div class=\"code-area\">\n                                <div class=\"line-numbers\" id=\"line-numbers\">1</div>\n                                <textarea id=\"code-input\" placeholder=\"// Начните писать код...\"></textarea>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"output-panel\">\n                        <div class=\"panel-header\">\n                            <div class=\"panel-title\">\n                                <i class=\"fas fa-terminal\"></i>\n                                <span>OUTPUT</span>\n                            </div>\n                        </div>\n                        <div class=\"panel-content\" id=\"output-content\">\n                            // Результат выполнения кода появится здесь\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Status Bar -->\n        <div class=\"status-bar\">\n            <div class=\"status-left\">\n                <div class=\"status-item\" id=\"status-info\">\n                    <span>Готов</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Create Project Modal -->\n    <div class=\"modal\" id=\"create-project-modal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <div class=\"modal-title\">Создать новый проект</div>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            <div class=\"modal-body\">\n                <div class=\"form-group\">\n                    <label class=\"form-label\">Название проекта</label>\n                    <input type=\"text\" class=\"form-input\" id=\"project-name\" placeholder=\"Мой проект\">\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"form-label\">Язык программирования</label>\n                    <select class=\"form-select\" id=\"project-language\">\n                        <option value=\"javascript\">JavaScript</option>\n                        <option value=\"html\">HTML</option>\n                        <option value=\"css\">CSS</option>\n                    </select>\n                </div>\n            </div>\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-secondary\" id=\"cancel-create\">Отмена</button>\n                <button class=\"btn\" id=\"confirm-create\">Создать</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        // Глобальные переменные для Construct 3\n        window.appData = {\n            projects: [],\n            currentProject: null\n        };\n\n        // DOM Elements\n        const projectManager = document.getElementById('project-manager');\n        const editorScreen = document.getElementById('editor-screen');\n        const createProjectBtn = document.getElementById('create-project-btn');\n        const loadProjectBtn = document.getElementById('load-project-btn');\n        const backToProjectsBtn = document.getElementById('back-to-projects');\n        const createProjectModal = document.getElementById('create-project-modal');\n        const cancelCreateBtn = document.getElementById('cancel-create');\n        const confirmCreateBtn = document.getElementById('confirm-create');\n        const modalCloseBtns = document.querySelectorAll('.modal-close');\n        const codeInput = document.getElementById('code-input');\n        const lineNumbers = document.getElementById('line-numbers');\n        const runBtn = document.getElementById('run-btn');\n        const saveProjectBtn = document.getElementById('save-project-btn');\n        const outputContent = document.getElementById('output-content');\n        const currentProjectName = document.getElementById('current-project-name');\n        const currentProjectLanguage = document.getElementById('current-project-language');\n        const statusInfo = document.getElementById('status-info');\n\n        // Безопасная работа с localStorage\n        function getSafeStorage() {\n            try {\n                const data = localStorage.getItem('codeProjects');\n                return data ? JSON.parse(data) : [];\n            } catch (e) {\n                console.log('LocalStorage недоступен, используем память');\n                return [];\n            }\n        }\n\n        function setSafeStorage(projects) {\n            try {\n                localStorage.setItem('codeProjects', JSON.stringify(projects));\n            } catch (e) {\n                console.log('Не удалось сохранить в LocalStorage');\n            }\n        }\n\n        // Initialize\n        function init() {\n            window.appData.projects = getSafeStorage();\n            updateStatus('Готов');\n            \n            // Используем onclick для лучшей совместимости\n            setupEventListeners();\n        }\n\n        function setupEventListeners() {\n            createProjectBtn.onclick = () => openModal(createProjectModal);\n            loadProjectBtn.onclick = () => loadProjectFromStorage();\n            backToProjectsBtn.onclick = backToProjectManager;\n            \n            confirmCreateBtn.onclick = createNewProject;\n            cancelCreateBtn.onclick = () => closeModal(createProjectModal);\n            \n            modalCloseBtns.forEach(btn => {\n                btn.onclick = function() {\n                    closeModal(this.closest('.modal'));\n                };\n            });\n\n            codeInput.oninput = updateLineNumbers;\n            runBtn.onclick = runCode;\n            saveProjectBtn.onclick = saveCurrentProject;\n        }\n\n        // Create new project\n        function createNewProject() {\n            const name = document.getElementById('project-name').value.trim() || 'Новый проект';\n            const language = document.getElementById('project-language').value;\n            \n            const project = {\n                id: Date.now().toString(),\n                name: name,\n                language: language,\n                code: getDefaultCode(language),\n                createdAt: new Date().toISOString(),\n                updatedAt: new Date().toISOString()\n            };\n            \n            window.appData.projects.push(project);\n            setSafeStorage(window.appData.projects);\n            openProject(project);\n            closeModal(createProjectModal);\n        }\n\n        // Load project from storage\n        function loadProjectFromStorage() {\n            if (window.appData.projects.length === 0) {\n                outputContent.innerHTML = '<div class=\"error-message\">Нет сохраненных проектов</div>';\n                return;\n            }\n            \n            // Просто загружаем последний проект для простоты\n            const project = window.appData.projects[window.appData.projects.length - 1];\n            openProject(project);\n        }\n\n        // Open project in editor\n        function openProject(project) {\n            window.appData.currentProject = project;\n            currentProjectName.textContent = project.name;\n            currentProjectLanguage.textContent = getLanguageName(project.language);\n            codeInput.value = project.code;\n            updateLineNumbers();\n            \n            projectManager.style.display = 'none';\n            editorScreen.style.display = 'flex';\n            \n            updateStatus(`Проект \"${project.name}\" загружен`);\n        }\n\n        // Save current project\n        function saveCurrentProject() {\n            if (!window.appData.currentProject) return;\n            \n            window.appData.currentProject.code = codeInput.value;\n            window.appData.currentProject.updatedAt = new Date().toISOString();\n            \n            const index = window.appData.projects.findIndex(p => p.id === window.appData.currentProject.id);\n            if (index !== -1) {\n                window.appData.projects[index] = window.appData.currentProject;\n                setSafeStorage(window.appData.projects);\n                updateStatus(`Проект \"${window.appData.currentProject.name}\" сохранен`);\n            }\n        }\n\n        // Run code - безопасная версия для iframe\n        function runCode() {\n            const code = codeInput.value;\n            outputContent.innerHTML = '';\n            \n            try {\n                if (window.appData.currentProject.language === 'javascript') {\n                    let output = '';\n                    const originalConsoleLog = console.log;\n                    console.log = function(...args) {\n                        output += args.map(arg => \n                            typeof arg === 'object' ? JSON.stringify(arg) : String(arg)\n                        ).join(' ') + '\\n';\n                    };\n\n                    // Безопасное выполнение кода\n                    new Function(code)();\n                    \n                    console.log = originalConsoleLog;\n                    \n                    if (output) {\n                        outputContent.innerHTML = `<div class=\"success-message\">${output}</div>`;\n                    } else {\n                        outputContent.innerHTML = '<div class=\"success-message\">Код выполнен (нет вывода)</div>';\n                    }\n                    \n                } else if (window.appData.currentProject.language === 'html') {\n                    // В iframe нельзя открывать новые окна, показываем код\n                    outputContent.innerHTML = `<div class=\"success-message\">HTML код:\\n\\n${code}</div>`;\n                    \n                } else if (window.appData.currentProject.language === 'css') {\n                    outputContent.innerHTML = '<div class=\"success-message\">CSS применен (эмуляция)</div>';\n                }\n                \n            } catch (error) {\n                outputContent.innerHTML = `<div class=\"error-message\">Ошибка: ${error.message}</div>`;\n            }\n        }\n\n        // Utility functions\n        function getLanguageName(language) {\n            const names = {\n                javascript: 'JavaScript',\n                html: 'HTML',\n                css: 'CSS'\n            };\n            return names[language] || language;\n        }\n\n        function getDefaultCode(language) {\n            const defaults = {\n                javascript: '// Начните писать код JavaScript...\\nconsole.log(\"Hello World!\");',\n                html: '<!-- Начните писать HTML код... -->\\n<html>\\n<head>\\n  <title>Мой сайт</title>\\n</head>\\n<body>\\n  <h1>Привет, мир!</h1>\\n</body>\\n</html>',\n                css: '/* Начните писать CSS код... */\\nbody {\\n  font-family: Arial, sans-serif;\\n  margin: 0;\\n  padding: 20px;\\n}'\n            };\n            return defaults[language] || '// Начните писать код...';\n        }\n\n        function updateLineNumbers() {\n            const lines = codeInput.value.split('\\n').length;\n            let numbers = '';\n            for (let i = 1; i <= lines; i++) {\n                numbers += i + '<br>';\n            }\n            lineNumbers.innerHTML = numbers;\n        }\n\n        function updateStatus(message) {\n            statusInfo.querySelector('span').textContent = message;\n        }\n\n        function openModal(modal) {\n            modal.style.display = 'flex';\n        }\n\n        function closeModal(modal) {\n            modal.style.display = 'none';\n        }\n\n        function backToProjectManager() {\n            editorScreen.style.display = 'none';\n            projectManager.style.display = 'flex';\n            window.appData.currentProject = null;\n            updateStatus('Готов');\n        }\n\n        // Делаем функции глобальными для отладки\n        window.runCode = runCode;\n        window.saveCurrentProject = saveCurrentProject;\n        window.initApp = init;\n\n        // Initialize when page loads\n        document.addEventListener('DOMContentLoaded', init);\n        \n        // Fallback initialization\n        window.onload = init;\n    </script>\n</body>\n</html>",true,"","fullscreen; autoplay; encrypted-media",true,"allow-scripts"],""]],[],0,true,false,false,[]]],[],[]]],[["Список событий 1",[]]],[],"media/",false,1080,1920,4,false,"trilinear",false,"1.0.0.0",false,true,3,1,3,false,true,1,true,0.7853981633974483,[],"icons/",[],"normalized","tyvass3asse","fonts/",[["Шкала 1",5,0.1,"default","default",[],0,0,1,"",1,1]],"high-performance",[],1761021217387,"vsync","com.web.test","icons/Иконка-загрузки.png",false,4,false,null,[],"folders",1,10000,false,[["Блок-схема 1",[]]],"auto"]}